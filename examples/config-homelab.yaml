# Homelab configuration with VMs, Docker, NAS, and Discord
ups:
  name: "UPS@192.168.1.100"
  check_interval: 1

triggers:
  low_battery_threshold: 25
  critical_runtime_threshold: 900
  extended_time:
    enabled: true
    threshold: 600

# ==============================================================================
# NOTIFICATIONS (via Apprise)
# ==============================================================================
notifications:
  # Custom title to identify this system in notifications
  title: "âš¡ Homelab UPS"

  # Custom avatar for Discord/Slack
  avatar_url: "https://raw.githubusercontent.com/m4r1k/Eneru/main/docs/images/eneru-avatar.png"

  urls:
    # Discord - get webhook URL from Server Settings > Integrations > Webhooks
    - "discord://YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN"

    # ntfy.sh - free, self-hostable push notifications
    # - "ntfy://mytopic"
    # - "ntfy://user:pass@ntfy.example.com/mytopic"

    # Telegram - create bot via @BotFather
    # - "tgram://BOT_TOKEN/CHAT_ID"

    # Pushover - reliable mobile push notifications
    # - "pover://USER_KEY@APP_TOKEN"

virtual_machines:
  enabled: true
  max_wait: 60

# Container Runtime (Docker/Podman)
containers:
  enabled: true
  runtime: "auto"  # auto-detects docker or podman
  stop_timeout: 60

  # Compose stacks to shutdown first (in order)
  compose_files:
    - path: "/opt/database/docker-compose.yml"
      stop_timeout: 120  # Give database more time
    - "/opt/apps/docker-compose.yml"

  # Shutdown remaining containers after compose stacks
  shutdown_all_remaining_containers: true

filesystems:
  sync_enabled: true
  unmount:
    enabled: true
    mounts:
      - path: "/mnt/nas"
        options: "-l"

# Remote servers with optional pre-shutdown commands
remote_servers:
  # Simple NAS - just shutdown command
  - name: "Synology NAS"
    enabled: true
    host: "192.168.1.50"
    user: "admin"
    shutdown_command: "sudo -i synoshutdown -s"

  # Proxmox hypervisor - gracefully stop VMs/CTs before shutdown
  - name: "Proxmox Host"
    enabled: true
    host: "192.168.1.60"
    user: "root"
    command_timeout: 30
    pre_shutdown_commands:
      - action: "stop_proxmox_vms"
        timeout: 180  # VMs may need time for graceful shutdown
      - action: "stop_proxmox_cts"
        timeout: 60
      - action: "sync"
    shutdown_command: "shutdown -h now"

local_shutdown:
  enabled: true
